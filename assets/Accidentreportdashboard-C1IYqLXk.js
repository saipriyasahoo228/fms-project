import{r as m,R as C,j as e,P as x}from"./index-K7U7e95_.js";import{T as B,a as H,v as W,b as z,c as F,d as L,e as M}from"./FilterList-D8MXzMaP.js";import{B as y,P as N,j as G,I as J}from"./IconButton-DDU6yx0X.js";import{T as K,a as Q,b as U,c as b,d as u,e as V}from"./TableRow-B_hpd-CW.js";const X=[{id:"accident_report_date",numeric:!1,disablePadding:!0,label:"Report Date"},{id:"whitelevel_id",numeric:!1,disablePadding:!1,label:"White Level ID"},{id:"accident_type",numeric:!0,disablePadding:!1,label:"Accident Type"},{id:"severity",numeric:!0,disablePadding:!1,label:"Severity"},{id:"accident_id",numeric:!1,disablePadding:!1,label:"Accident ID"},{id:"workmen_count",numeric:!0,disablePadding:!1,label:"Workmen Involved"},{id:"workmen_names",numeric:!1,disablePadding:!1,label:"Workmen Names"}];function P(i,c,t){return c[t]<i[t]?-1:c[t]>i[t]?1:0}function Y(i,c){return i==="desc"?(t,r)=>P(t,r,c):(t,r)=>-P(t,r,c)}function Z(i,c){const t=i.map((r,a)=>[r,a]);return t.sort((r,a)=>{const s=c(r[0],a[0]);return s!==0?s:r[1]-a[1]}),t.map(r=>r[0])}function T(i){const{order:c,orderBy:t,onRequestSort:r}=i,a=s=>h=>{r(h,s)};return e.jsx(V,{children:e.jsx(b,{children:X.map(s=>e.jsx(u,{align:s.numeric?"right":"left",padding:s.disablePadding?"4":"normal",sortDirection:t===s.id?c:!1,children:e.jsxs(H,{active:t===s.id,direction:t===s.id?c:"asc",onClick:a(s.id),children:[s.label,t===s.id?e.jsx(y,{component:"span",sx:W,children:c==="desc"?"sorted descending":"sorted ascending"}):null]})},s.id))})})}T.propTypes={onRequestSort:x.func.isRequired,order:x.oneOf(["asc","desc"]).isRequired,orderBy:x.string.isRequired};function R(i){const{numSelected:c}=i;return e.jsxs(z,{sx:{pl:{sm:2},pr:{xs:1,sm:1},...c>0&&{bgcolor:t=>F(t.palette.primary.main,t.palette.action.activatedOpacity)}},children:[e.jsx(G,{sx:{flex:"1 1 100%"},variant:"h6",id:"tableTitle",component:"div",children:"ACCIDENT REPORTS"}),e.jsx(L,{title:"Filter list",children:e.jsx(J,{children:e.jsx(M,{})})})]})}R.propTypes={numSelected:x.number.isRequired};function ae(){const[i,c]=m.useState("asc"),[t,r]=m.useState("accident_report_date"),[a,s]=m.useState([]),[h,j]=m.useState(0),[g,S]=m.useState(5),[f,w]=m.useState([]);m.useEffect(()=>{(async()=>{try{const d=await fetch("/data.json");if(!d.ok)throw new Error("Failed to fetch data");const o=(await d.json()).map((p,O)=>({id:O+1,accident_report_date:p.accident_report_date,whitelevel_id:p.whitelevel_id,accident_type:p.accident_type,severity:p.severity,accident_id:p.accident_id,workmen_count:p.workmen_involved.count,workmen_names:p.workmen_involved.names.map(A=>A.employee_name).join(", ")}));w(o)}catch(d){console.error("Error fetching data:",d)}})()},[]);const k=(n,d)=>{c(t===d&&i==="asc"?"desc":"asc"),r(d)},I=(n,d)=>{const l=a.indexOf(d);let o=[];l===-1?o=o.concat(a,d):l===0?o=o.concat(a.slice(1)):l===a.length-1?o=o.concat(a.slice(0,-1)):l>0&&(o=o.concat(a.slice(0,l),a.slice(l+1))),s(o)},D=(n,d)=>{j(d)},E=n=>{S(parseInt(n.target.value,10)),j(0)},_=n=>a.indexOf(n)!==-1,v=h>0?Math.max(0,(1+h)*g-f.length):0,q=C.useMemo(()=>Z(f,Y(i,t)).slice(h*g,h*g+g),[i,t,h,f,g]);return e.jsx(y,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"70vh"},children:e.jsxs(N,{sx:{width:"100%",mb:2},children:[e.jsx(R,{numSelected:a.length}),e.jsx(K,{children:e.jsxs(Q,{"aria-labelledby":"tableTitle",size:"medium",children:[e.jsx(T,{order:i,orderBy:t,onRequestSort:k}),e.jsxs(U,{children:[q.map((n,d)=>e.jsxs(b,{hover:!0,onClick:l=>I(l,n.id),role:"checkbox","aria-checked":_(n.id),tabIndex:-1,selected:_(n.id),sx:{cursor:"pointer"},children:[e.jsx(u,{component:"th",scope:"row",padding:"4",children:n.accident_report_date}),e.jsx(u,{align:"left",children:n.whitelevel_id}),e.jsx(u,{align:"right",children:n.accident_type}),e.jsx(u,{align:"right",children:n.severity}),e.jsx(u,{align:"left",children:n.accident_id}),e.jsx(u,{align:"right",children:n.workmen_count}),e.jsx(u,{align:"left",children:n.workmen_names})]},n.id)),v>0&&e.jsx(b,{style:{height:53*v},children:e.jsx(u,{colSpan:7})})]})]})}),e.jsx(B,{rowsPerPageOptions:[5,10,25],component:"div",count:f.length,rowsPerPage:g,page:h,onPageChange:D,onRowsPerPageChange:E})]})})}export{ae as A};
